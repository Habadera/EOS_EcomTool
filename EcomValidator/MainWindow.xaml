<Window x:Class="EcomValidator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Ecom Validator"
        Width="1450" Height="1000"
        MinWidth="1000" MinHeight="800"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource Brush.WindowBackground}"
        Foreground="{DynamicResource Brush.FG}">

    <Window.Resources>
        <Color x:Key="Color.Background">#1E1E1E</Color>
        <Color x:Key="Color.Panel">#252526</Color>
        <Color x:Key="Color.Border">#3E3E42</Color>
        <Color x:Key="Color.FG">#F1F1F1</Color>
        <Color x:Key="Color.FG.Muted">#AAAAAA</Color>
        <Color x:Key="Color.Input">#333337</Color>
        <Color x:Key="Color.Input.Focus">#3F3F46</Color>
        <Color x:Key="Color.RowAlt">#2D2D30</Color>
        <Color x:Key="Color.RowSel">#094771</Color>
        <Color x:Key="Color.Header">#2D2D30</Color>
        <Color x:Key="Color.Button.Normal">#3E3E42</Color>
        <Color x:Key="Color.Button.Hover">#505050</Color>
        <Color x:Key="Color.Button.Pressed">#007ACC</Color>
        <Color x:Key="Color.Selection">#007ACC</Color>
        <Color x:Key="Color.Success">#2E7D32</Color>

        <SolidColorBrush x:Key="Brush.WindowBackground" Color="{StaticResource Color.Background}" />
        <SolidColorBrush x:Key="Brush.Panel" Color="{StaticResource Color.Panel}" />
        <SolidColorBrush x:Key="Brush.Border" Color="{StaticResource Color.Border}" />
        <SolidColorBrush x:Key="Brush.FG" Color="{StaticResource Color.FG}" />
        <SolidColorBrush x:Key="Brush.FG.Muted" Color="{StaticResource Color.FG.Muted}" />
        <SolidColorBrush x:Key="Brush.Input" Color="{StaticResource Color.Input}" />
        <SolidColorBrush x:Key="Brush.Input.Focus" Color="{StaticResource Color.Input.Focus}" />
        <SolidColorBrush x:Key="Brush.RowAlt" Color="{StaticResource Color.RowAlt}" />
        <SolidColorBrush x:Key="Brush.RowSel" Color="{StaticResource Color.RowSel}" />
        <SolidColorBrush x:Key="Brush.Header" Color="{StaticResource Color.Header}" />
        <SolidColorBrush x:Key="Brush.Button.Normal" Color="{StaticResource Color.Button.Normal}"/>
        <SolidColorBrush x:Key="Brush.Button.Hover"  Color="{StaticResource Color.Button.Hover}"/>
        <SolidColorBrush x:Key="Brush.Button.Pressed" Color="{StaticResource Color.Button.Pressed}"/>
        <SolidColorBrush x:Key="Brush.Selection" Color="{StaticResource Color.Selection}"/>
        <SolidColorBrush x:Key="Brush.Success" Color="{StaticResource Color.Success}"/>

        <Style TargetType="Label">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}" />
        </Style>
        <Style TargetType="GroupBox">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}" />
        </Style>

        <Style x:Key="FormTextBox" TargetType="TextBox">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}" />
            <Setter Property="Padding" Value="6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{DynamicResource Brush.Input}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="FormPasswordBox" TargetType="PasswordBox">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}" />
            <Setter Property="Padding" Value="6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{DynamicResource Brush.Input}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="FormDatePicker" TargetType="DatePicker">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}" />
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style TargetType="Button">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}" />
            <Setter Property="Background" Value="{DynamicResource Brush.Button.Normal}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="10,6" />
            <Setter Property="Margin" Value="4" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource Brush.Button.Hover}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource Brush.Button.Pressed}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="{x:Type ComboBox}">
            <Setter Property="Background" Value="{DynamicResource Brush.Input}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                            </Grid.ColumnDefinitions>
                            <Border x:Name="Bd" Grid.ColumnSpan="2" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1" CornerRadius="2"/>
                            <TextBlock Grid.Column="0" Margin="8,2,6,2" VerticalAlignment="Center" Text="{TemplateBinding Text}" Foreground="{TemplateBinding Foreground}" TextTrimming="CharacterEllipsis"/>
                            <ToggleButton Grid.Column="1" Focusable="False" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Background="Transparent" BorderThickness="0">
                                <Path Data="M 0 0 L 4 4 L 8 0 Z" Stretch="Uniform" Width="8" Height="5" VerticalAlignment="Center" HorizontalAlignment="Center" Fill="{DynamicResource Brush.FG}"/>
                            </ToggleButton>
                            <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                <Border Background="{DynamicResource Brush.Panel}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1"
                                        MinWidth="{Binding ActualWidth, ElementName=Bd}">
                                    <ScrollViewer>
                                        <ItemsPresenter/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="{x:Type ComboBoxItem}">
            <Setter Property="Background" Value="{DynamicResource Brush.Panel}"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Style.Triggers>
                <Trigger Property="IsHighlighted" Value="True">
                    <Setter Property="Background" Value="{DynamicResource Brush.Selection}"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{DynamicResource Brush.Selection}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="{x:Type MenuItem}">
            <Setter Property="Background" Value="{DynamicResource Brush.Panel}"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" SnapsToDevicePixels="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" SharedSizeGroup="Icon"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto" SharedSizeGroup="Shortcut"/>
                                    <ColumnDefinition Width="13"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter x:Name="Icon" Margin="6,0,6,0" VerticalAlignment="Center" ContentSource="Icon"/>
                                <ContentPresenter x:Name="HeaderHost" Grid.Column="1" ContentSource="Header" Margin="0,0,10,0" RecognizesAccessKey="True" VerticalAlignment="Center"/>
                                <TextBlock x:Name="InputGestureText" Grid.Column="2" Text="{TemplateBinding InputGestureText}" Margin="5,2,2,2" DockPanel.Dock="Right" />
                                <Popup x:Name="Popup" Placement="Right" IsOpen="{TemplateBinding IsSubmenuOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Fade">
                                    <Border Background="{DynamicResource Brush.Panel}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1" Padding="2">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource Brush.Button.Hover}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="{DynamicResource Brush.FG.Muted}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}" />
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="RowBackground" Value="{DynamicResource Brush.Panel}"/>
            <Setter Property="AlternatingRowBackground" Value="{DynamicResource Brush.RowAlt}"/>
            <Setter Property="Background" Value="{DynamicResource Brush.Panel}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="{DynamicResource Brush.Header}"/>
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="{DynamicResource Brush.Panel}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Border}" />
            <Setter Property="BorderThickness" Value="0,0,0,1" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{DynamicResource Brush.RowSel}"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{DynamicResource Brush.RowSel}"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DetailLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG.Muted}"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Margin" Value="0,0,5,2"/>
        </Style>
        <Style x:Key="DetailValue" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource Brush.FG}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,20,10"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>

    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="False" Margin="0,0,0,10">
            <TextBlock Text="Ecom Validator" FontSize="20" FontWeight="Bold" Foreground="{DynamicResource Brush.FG}"/>
            <Menu DockPanel.Dock="Right" Background="Transparent" Foreground="{DynamicResource Brush.FG}">
                <MenuItem Header="Options">
                    <MenuItem Header="Clear All Credentials" Click="ClearCredentialsBtn_Click"/>
                    <MenuItem Header="Exit" Click="Menu_Exit_Click"/>
                </MenuItem>
                <MenuItem Header="About" Click="Menu_About_Click"/>
            </Menu>
        </DockPanel>

        <GroupBox Grid.Row="1" Header="Credentials &amp; Profiles" Padding="10" Margin="0,0,0,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" MinWidth="100"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto" MinWidth="100"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Label Grid.Row="0" Grid.Column="0" Content="Profile:"/>
                <Grid Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="4" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <ComboBox x:Name="ProfileCombo" Grid.Column="0" SelectionChanged="ProfileCombo_SelectionChanged" DisplayMemberPath="Name" VerticalAlignment="Center"/>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="10,0,0,0">
                        <Button x:Name="BtnNewProfile" Content="New" Click="BtnNewProfile_Click" Width="60" Padding="4"/>
                        <Button x:Name="BtnRenameProfile" Content="Rename" Click="BtnRenameProfile_Click" Width="70" Padding="4"/>
                        <Button x:Name="BtnSaveProfile" Content="Save" Click="BtnSaveProfile_Click" Width="60" Padding="4"/>
                        <Button x:Name="BtnDeleteProfile" Content="Delete" Click="BtnDeleteProfile_Click" Width="60" Padding="4" Background="#8B0000"/>
                    </StackPanel>
                </Grid>

                <Label Grid.Row="1" Grid.Column="0" Content="Product ID:"/>
                <TextBox x:Name="ProductIdBox" Grid.Row="1" Grid.Column="1" Style="{StaticResource FormTextBox}"/>

                <Label Grid.Row="1" Grid.Column="2" Content="Sandbox ID:"/>
                <TextBox x:Name="SandboxIdBox" Grid.Row="1" Grid.Column="3" Style="{StaticResource FormTextBox}"/>

                <Label Grid.Row="2" Grid.Column="0" Content="Deployment ID:"/>
                <TextBox x:Name="DeploymentIdBox" Grid.Row="2" Grid.Column="1" Style="{StaticResource FormTextBox}"/>

                <Label Grid.Row="2" Grid.Column="2" Content="Client ID:"/>
                <TextBox x:Name="ClientIdBox" Grid.Row="2" Grid.Column="3" Style="{StaticResource FormTextBox}"/>

                <Label Grid.Row="3" Grid.Column="0" Content="Client Secret:"/>
                <PasswordBox x:Name="ClientSecretBox" Grid.Row="3" Grid.Column="1" Style="{StaticResource FormPasswordBox}"/>

                <StackPanel Grid.Row="1" Grid.RowSpan="3" Grid.Column="4" VerticalAlignment="Center" Margin="10,0,0,0">
                    <Button x:Name="InitBtn" Content="Init &amp; Connect" Click="InitBtn_Click" Width="140" Height="40" Padding="10,6" FontWeight="Bold"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <TabControl Grid.Row="2" Background="Transparent" BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Foreground" Value="{DynamicResource Brush.FG}"/>
                    <Setter Property="Background" Value="{DynamicResource Brush.Panel}"/>
                    <Setter Property="FontSize" Value="14"/>
                    <Setter Property="Padding" Value="15,8"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="Border" Background="{TemplateBinding Background}" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1,1,1,0" Margin="0,0,4,0" CornerRadius="4,4,0,0">
                                    <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header" Margin="10,2"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.Button.Pressed}"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.Button.Hover}"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>

            <TabItem Header="Order Info">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0" Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <Label Content="Environment:"/>
                            <ComboBox x:Name="OrderEnvCombo" Width="150" Padding="6" SelectionChanged="OrderEnvCombo_SelectionChanged">
                                <ComboBoxItem Content="Prod" IsSelected="True"/>
                                <ComboBoxItem Content="Custom"/>
                            </ComboBox>
                            <TextBox x:Name="OrderCustomBaseUrlBox" Visibility="Collapsed" Margin="0,5,0,0" Width="150" ToolTip="Custom Base URL"/>
                        </StackPanel>

                        <DockPanel Grid.Column="1">
                            <Label Content="Order IDs (One per line, comma or space):" DockPanel.Dock="Top"/>
                            <TextBox x:Name="OrderIdBox" 
                                     AcceptsReturn="True" 
                                     TextWrapping="Wrap" 
                                     VerticalScrollBarVisibility="Auto"
                                     Style="{StaticResource FormTextBox}"
                                     Height="60"/>
                        </DockPanel>

                        <StackPanel Grid.Column="2" VerticalAlignment="Bottom" Margin="10,0,0,0">
                            <Button x:Name="OrderFetchBtn" Content="Fetch Orders" Click="OrderFetchBtn_Click" FontWeight="Bold"/>
                            <Button x:Name="CopyOrderJsonBtn" Content="Copy JSON" Click="CopyOrderJsonBtn_Click"/>
                        </StackPanel>
                    </Grid>

                    <DataGrid x:Name="OrderHeaderGrid" 
                              Grid.Row="1" 
                              ItemsSource="{Binding}"
                              RowDetailsVisibilityMode="Collapsed"
                              SelectionMode="Single"
                              BorderBrush="{DynamicResource Brush.Border}"
                              BorderThickness="1"
                              ScrollViewer.CanContentScroll="False">

                        <DataGrid.Columns>
                            <DataGridTemplateColumn Width="40">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ToggleButton Click="RowExpander_Click"
                                                      IsChecked="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}, Mode=OneWay}"
                                                      Width="24" Height="24"
                                                      Background="Transparent" Foreground="{DynamicResource Brush.FG}" BorderThickness="0">
                                            <ToggleButton.Style>
                                                <Style TargetType="ToggleButton">
                                                    <Setter Property="Content" Value="+"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DetailsVisibility, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="Visible">
                                                            <Setter Property="Content" Value="-"/>
                                                            <Setter Property="FontWeight" Value="Bold"/>
                                                            <Setter Property="IsChecked" Value="True"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ToggleButton.Style>
                                        </ToggleButton>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Header="Order ID" Binding="{Binding OrderId}" Width="*" MinWidth="180"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding OrderStatus}" Width="120"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding CreationDate}" Width="180"/>
                            <DataGridTextColumn Header="Total" Binding="{Binding TotalPrice}" Width="100"/>
                            <DataGridTextColumn Header="Currency" Binding="{Binding Currency}" Width="80"/>
                        </DataGrid.Columns>

                        <DataGrid.RowDetailsTemplate>
                            <DataTemplate>
                                <Border Background="#1A1A1A" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="0,1,0,1" Padding="20">
                                    <StackPanel HorizontalAlignment="Stretch">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="ORDER DETAILS" FontWeight="Bold" Foreground="#007ACC" Margin="0,0,0,10"/>
                                                <TextBlock Text="Order ID" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding OrderId}" Style="{StaticResource DetailValue}"/>
                                                <TextBlock Text="Invoice ID" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding InvoiceId}" Style="{StaticResource DetailValue}"/>
                                                <TextBlock Text="Parent Order ID" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding ParentOrderId}" Style="{StaticResource DetailValue}"/>
                                                <TextBlock Text="Order Type" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding OrderType}" Style="{StaticResource DetailValue}"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="FINANCIALS" FontWeight="Bold" Foreground="#007ACC" Margin="0,0,0,10"/>
                                                <TextBlock Text="Total Price" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Style="{StaticResource DetailValue}">
                                                    <TextBlock.Text>
                                                        <MultiBinding StringFormat="{}{0} {1}">
                                                            <Binding Path="Symbol"/>
                                                            <Binding Path="TotalPrice"/>
                                                        </MultiBinding>
                                                    </TextBlock.Text>
                                                </TextBlock>
                                                <TextBlock Text="Total Tax" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding TotalTax}" Style="{StaticResource DetailValue}"/>
                                                <TextBlock Text="Total Discounted" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding TotalDiscounted}" Style="{StaticResource DetailValue}"/>
                                                <TextBlock Text="Currency" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding Currency}" Style="{StaticResource DetailValue}"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="TIMESTAMPS" FontWeight="Bold" Foreground="#007ACC" Margin="0,0,0,10"/>
                                                <TextBlock Text="Creation Date" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding CreationDate}" Style="{StaticResource DetailValue}"/>
                                                <TextBlock Text="Completed At" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding CompletedAt}" Style="{StaticResource DetailValue}"/>
                                                <TextBlock Text="Last Modified" Style="{StaticResource DetailLabel}"/>
                                                <TextBlock Text="{Binding LastModifiedDate}" Style="{StaticResource DetailValue}"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="3">
                                                <TextBlock Text="STATUS" FontWeight="Bold" Foreground="#007ACC" Margin="0,0,0,10"/>
                                                <TextBlock Text="Order Status" Style="{StaticResource DetailLabel}"/>
                                                <Border Background="#333" CornerRadius="4" Padding="8,4" HorizontalAlignment="Left" Margin="0,0,0,10">
                                                    <TextBlock Text="{Binding OrderStatus}" FontWeight="Bold" Foreground="White"/>
                                                </Border>
                                            </StackPanel>
                                        </Grid>

                                        <Separator Background="{DynamicResource Brush.Border}" Margin="0,15"/>

                                        <TextBlock Text="LINE OFFERS" FontWeight="Bold" Foreground="#007ACC" Margin="0,0,0,10"/>

                                        <ItemsControl ItemsSource="{Binding LineOffers}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border BorderBrush="#333" BorderThickness="0,0,0,1" Margin="0,0,0,10" Padding="0,0,0,10">
                                                        <StackPanel>
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="2*"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                    <ColumnDefinition Width="1.5*"/>
                                                                    <ColumnDefinition Width="1.5*"/>
                                                                </Grid.ColumnDefinitions>

                                                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                                    <TextBlock Text="Offer Title" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding Title}" Style="{StaticResource DetailValue}" Foreground="White" TextWrapping="Wrap"/>
                                                                    <TextBlock Text="Offer ID" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding OfferId}" Style="{StaticResource DetailValue}" FontFamily="Consolas"/>
                                                                </StackPanel>

                                                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                                    <TextBlock Text="Quantity" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding Quantity}" Style="{StaticResource DetailValue}"/>
                                                                    <TextBlock Text="Unit Price" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding UnitPrice}" Style="{StaticResource DetailValue}"/>
                                                                </StackPanel>

                                                                <StackPanel Grid.Column="2" Margin="0,0,10,0">
                                                                    <TextBlock Text="Total Price" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding TotalPrice}" Style="{StaticResource DetailValue}"/>
                                                                    <TextBlock Text="Discounted Price" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding DiscountedPrice}" Style="{StaticResource DetailValue}"/>
                                                                </StackPanel>

                                                                <StackPanel Grid.Column="3" Margin="0,0,10,0">
                                                                    <TextBlock Text="Seller Name" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding SellerName}" Style="{StaticResource DetailValue}"/>
                                                                    <TextBlock Text="Seller ID" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding SellerId}" Style="{StaticResource DetailValue}" FontFamily="Consolas"/>
                                                                </StackPanel>

                                                                <StackPanel Grid.Column="4">
                                                                    <TextBlock Text="Namespace" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding Namespace}" Style="{StaticResource DetailValue}" FontFamily="Consolas"/>
                                                                    <TextBlock Text="Display Name" Style="{StaticResource DetailLabel}"/>
                                                                    <TextBlock Text="{Binding NamespaceDisplayName}" Style="{StaticResource DetailValue}"/>
                                                                </StackPanel>
                                                            </Grid>

                                                            <StackPanel Margin="0,10,0,0">
                                                                <TextBlock Text="OFFER ITEMS" FontWeight="Bold" Foreground="#007ACC" Margin="0,0,0,10"/>
                                                                <DataGrid ItemsSource="{Binding OfferItems}" AutoGenerateColumns="False" Background="#222" BorderBrush="#444" BorderThickness="1" HeadersVisibility="Column" GridLinesVisibility="Horizontal" HorizontalGridLinesBrush="#333" Margin="0,0,0,0">
                                                                    <DataGrid.Columns>
                                                                        <DataGridTextColumn Header="Item ID" Binding="{Binding ItemId}" Width="280" FontFamily="Consolas"/>
                                                                        <DataGridTextColumn Header="Entitlement ID" Binding="{Binding EntitlementId}" Width="280" FontFamily="Consolas"/>
                                                                        <DataGridTextColumn Header="Status" Binding="{Binding EntitlementStatus}" Width="100"/>
                                                                        <DataGridTextColumn Header="Redeemed?" Binding="{Binding EntitlementRedeemed}" Width="100"/>
                                                                        <DataGridTextColumn Header="Redeemed At" Binding="{Binding EntitlementRedeemedAt}" Width="150"/>
                                                                    </DataGrid.Columns>
                                                                </DataGrid>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </DataGrid.RowDetailsTemplate>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="User Info">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Content="Identity ID:"/>
                        <TextBox x:Name="UserIdentityIdBox" Grid.Column="1" Style="{StaticResource FormTextBox}"/>

                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <Button x:Name="UserFetchBtn" Content="Fetch Info" Click="UserFetchBtn_Click" FontWeight="Bold"/>
                            <Button x:Name="CopyUserJsonBtn" Content="Copy JSON" Click="CopyUserJsonBtn_Click"/>
                            <Button Content="Load Map" Click="LoadOfferMapBtn_Click" ToolTip="Load Offer Names CSV"/>
                        </StackPanel>
                    </Grid>

                    <DataGrid x:Name="UserInfoGrid" Grid.Row="1" ItemsSource="{Binding}" Margin="0,10,0,0" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Offer Name" Binding="{Binding OfferName}" Width="200"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                            <DataGridTextColumn Header="Redeemed?" Binding="{Binding IsRedeemed}" Width="120"/>
                            <DataGridTextColumn Header="Grant Date" Binding="{Binding GrantDate}" Width="150"/>
                            <DataGridTextColumn Header="Entitlement ID" Binding="{Binding EntitlementId}" Width="300"/>
                            <DataGridTextColumn Header="Catalog Item ID" Binding="{Binding CatalogItemId}" Width="300"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

        </TabControl>

        <Border Grid.Row="3" Background="#111" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="0,1,0,0" Height="120" Margin="0,10,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <DockPanel Grid.Row="0" Margin="5">
                    <TextBlock Text="Activity Log" FontSize="12" Foreground="#888" DockPanel.Dock="Left"/>
                    <Button Content="Clear" DockPanel.Dock="Right" Padding="4,2" FontSize="10" Click="ClearLog_Click"/>
                </DockPanel>
                <TextBox x:Name="LogText" Grid.Row="1"
                         Background="Transparent" Foreground="#DDD" 
                         BorderThickness="0" 
                         IsReadOnly="True" 
                         TextWrapping="Wrap" 
                         FontFamily="Consolas" 
                         Padding="5"
                         VerticalScrollBarVisibility="Auto"/>
            </Grid>
        </Border>
    </Grid>
</Window>